<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GhostWire // SECURE_NODE_V9</title>
    <!-- Cyberpunk Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap"
        rel="stylesheet">
    <!-- Main Style -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- SocketIO -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
</head>

<body>
    <div class="scanline"></div>
    <div class="glitch-overlay"></div>

    <div class="container-fluid h-100 cyber-container">
        <!-- LOGIN / LOBBY SCREEN -->
        <div id="login-screen" class="cyber-panel center-screen">
            <h1 class="cyber-title glitch" data-text="GHOSTWIRE">GHOSTWIRE</h1>

            <!-- IDENTIFICATION -->
            <div class="cyber-input-group">
                <input type="text" id="username" class="cyber-input" placeholder="CODENAME" autocomplete="off">
            </div>

            <!-- ACTION SELECTION -->
            <div id="lobby-actions">
                <button id="btn-create-server" class="cyber-btn mb-3">CREATE SECURE NODE</button>
                <button id="btn-show-join" class="cyber-btn outline">JOIN FREQUENCY</button>
            </div>

            <!-- JOIN INPUTS -->
            <div id="join-inputs" class="hidden mt-3">
                <input type="text" id="room-code-input" class="cyber-input" placeholder="FREQUENCY CODE (6-CHAR)"
                    autocomplete="off" maxlength="6">
                <div class="row">
                    <button id="btn-join-server" class="cyber-btn">CONNECT</button>
                    <button id="btn-back-lobby" class="cyber-btn sm outline">BACK</button>
                </div>
            </div>
        </div>

        <!-- CHAT INTERFACE -->
        <div id="chat-interface" class="hidden">
            <div class="header-bar">
                <div class="status-indicator online"></div>
                <span class="terminal-text">NET_STATUS: SECURE // ENCRYPTION: FERNET-256</span>
                <button id="btn-disconnect" class="cyber-btn sm">SEVER LINK</button>
            </div>

            <div class="main-grid">
                <!-- Sidebar -->
                <div class="sidebar cyber-border">
                    <h3 class="cyber-subtitle">OPERATIVES</h3>
                    <ul id="user-list" class="terminal-list">
                        <!-- Users go here -->
                    </ul>
                </div>

                <!-- Chat Area -->
                <div class="chat-area cyber-border">
                    <div id="chat-window" class="chat-window">
                        <!-- Messages go here -->
                        <div class="system-msg">>> SYSTEM READY. WAITING FOR INPUT...</div>
                    </div>

                    <div class="input-area">
                        <div class="upload-zone">
                            <label for="file-input" class="cyber-icon-btn" title="UPLOAD GHOST IMAGE">
                                ðŸ“·
                            </label>
                            <input type="file" id="file-input" accept="image/png, image/jpeg" hidden>
                        </div>
                        <input type="text" id="message-input" class="cyber-input flex-grow"
                            placeholder="TRANSMIT DATA..." autocomplete="off">

                        <!-- PRE-SEND PASSPHRASE INPUT (Hidden by default, shown when image selected) -->
                        <div id="secure-options" class="hidden">
                            <input type="password" id="encrypt-pass" class="cyber-input sm-input"
                                placeholder="ENCRYPTION KEY (REQUIRED)">
                            <label class="cyber-checkbox-label">
                                <input type="checkbox" id="self-destruct-check"> <span class="glitch-text">SELF-DESTRUCT
                                    (30s)</span>
                            </label>
                        </div>

                        <button id="btn-send" class="cyber-btn">SEND</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- MODAL FOR DECRYPT INPUT -->
    <div id="auth-modal" class="modal hidden">
        <div class="modal-content cyber-panel">
            <span class="close-modal" id="close-auth">&times;</span>
            <h2 class="cyber-subtitle">SECURITY CLEARANCE REQUIRED</h2>
            <p>Enter the encryption key to reveal this node.</p>
            <input type="password" id="decrypt-pass" class="cyber-input" placeholder="PASSPHRASE">
            <button id="btn-decrypt-confirm" class="cyber-btn mt-3">ACCESS DATA</button>
        </div>
    </div>

    <!-- MODAL FOR DECRYPTED MESSAGE -->
    <div id="decrypt-modal" class="modal hidden">
        <div class="modal-content cyber-panel">
            <span class="close-modal">&times;</span>
            <h2 class="cyber-title warning">DECRYPTED INTELLIGENCE</h2>
            <div id="decrypted-content" class="decrypted-text"></div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>